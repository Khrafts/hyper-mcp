# Operations Guide> **Production-ready deployment** and monitoring for enterprise-grade AI-DeFi infrastructure üöÄThis guide covers everything you need to deploy, monitor, and maintain **hl-eco-mcp** in production environments. From single-instance deployments to high-availability clusters.## üöÄ Deployment Options### NPM Package (Recommended)`bash# Global installationnpm install -g hl-eco-mcp# Run in productionNODE_ENV=production hl-eco-mcp# With process managerpm2 start hl-eco-mcp --name "hyperliquid-mcp"`### Docker Deployment`bash# Official imagedocker run -d --name hl-eco-mcp \  -p 3000:3000 \  -e HYPERLIQUID_PRIVATE_KEY=your_key \  -e NODE_ENV=production \  khrafts/hl-eco-mcp:latest# Docker Composeversion: '3.8'services:  hl-eco-mcp:    image: khrafts/hl-eco-mcp:latest    ports:      - "3000:3000"    environment:      - NODE_ENV=production      - HYPERLIQUID_PRIVATE_KEY=${HYPERLIQUID_PRIVATE_KEY}    restart: unless-stopped`### Kubernetes Deployment`yamlapiVersion: apps/v1kind: Deploymentmetadata:  name: hl-eco-mcpspec:  replicas: 3  selector:    matchLabels:      app: hl-eco-mcp  template:    spec:      containers:      - name: hl-eco-mcp        image: khrafts/hl-eco-mcp:latest        ports:        - containerPort: 3000        env:        - name: NODE_ENV          value: production        - name: HYPERLIQUID_PRIVATE_KEY          valueFrom:            secretKeyRef:              name: hyperliquid-secrets              key: private-key`## üë©‚Äç‚öïÔ∏è Health Monitoring### Built-in Health Checks`bash# System informationcurl http://localhost:3000/tools/system_info# Health check (all adapters, tools, sessions)curl http://localhost:3000/tools/health_check# HyperLiquid integration healthcurl http://localhost:3000/tools/hyperliquid_health_check`### Health Check Response`json{  "status": "healthy",  "timestamp": "2024-01-15T10:30:00Z",  "services": {    "hyperliquid": {      "status": "healthy",      "latency": 145,      "last_check": "2024-01-15T10:29:55Z"    },    "community_protocols": {      "loaded": 5,      "active": 5,      "errors": 0    }  },  "uptime": 86400,  "memory_usage": "142MB",  "active_sessions": 12}`### Logging Configuration`bash# Production logging (JSON format)LOG_LEVEL=info NODE_ENV=production hl-eco-mcp# Debug modeLOG_LEVEL=debug hl-eco-mcp# Disable console logging (file only)ENABLE_CONSOLE_LOGGING=false hl-eco-mcp`## üìä Observability & Monitoring### Key Metrics to Monitor#### Server Metrics- **Request Rate**: MCP requests per minute- **Response Time**: P95/P99 latencies for tool calls- **Error Rate**: Failed requests as % of total- **Active Sessions**: Concurrent AI agent connections#### Integration Health- **HyperLiquid API**: Response times, error rates, WebSocket status- **Community Protocols**: Protocol availability, validation errors- **Rate Limiting**: API quota usage, throttling events### Log Aggregation#### ELK Stack Integration`yaml# filebeat.ymlfilebeat.inputs:- type: docker  containers.ids:    - "*"  processors:    - add_docker_metadata: ~    - decode_json_fields:        fields: ["message"]        target: ""output.elasticsearch:  hosts: ["elasticsearch:9200"]`#### Datadog Integration`bash# Add Datadog agent as sidecardocker run -d --name datadog-agent \  -v /var/run/docker.sock:/var/run/docker.sock:ro \  -v /proc/:/host/proc/:ro \  -v /sys/fs/cgroup/:/host/sys/fs/cgroup:ro \  -e DD_API_KEY=your_api_key \  -e DD_LOGS_ENABLED=true \  -e DD_LOGS_CONFIG_CONTAINER_COLLECT_ALL=true \  datadog/agent:latest`### Alerting Rules- **High Error Rate**: >5% errors for 5 minutes- **API Latency**: P95 >2s for 3 minutes - **WebSocket Disconnection**: HyperLiquid feed down >30s- **Memory Usage**: >80% for 10 minutes- **Disk Space**: >85% used## ‚ö° Performance Optimization### Configuration Tuning`bash# High-throughput configurationMAX_CONCURRENT_REQUESTS=50          # Default: 10CACHE_TTL_SECONDS=30                # Default: 60API_TIMEOUT_MS=15000                # Default: 30000API_RATE_LIMIT_REQUESTS_PER_MINUTE=300  # Default: 60# Memory optimizationNODE_OPTIONS="--max-old-space-size=2048"  # 2GB heap`### Load Testing`bash# Install load testing toolsnpm install -g artillery# Basic load testecho 'config:  target: http://localhost:3000  phases:    - duration: 60      arrivalRate: 10scenarios:  - name: health_check    requests:      - get:          url: /tools/health_check' > loadtest.ymlarllery run loadtest.yml`### Horizontal Scaling`bash# Run multiple instances behind load balancerdocker-compose scale hl-eco-mcp=3# Kubernetes horizontal pod autoscalerapiVersion: autoscaling/v2kind: HorizontalPodAutoscalermetadata:  name: hl-eco-mcp-hpaspec:  scaleTargetRef:    apiVersion: apps/v1    kind: Deployment    name: hl-eco-mcp  minReplicas: 2  maxReplicas: 10  metrics:  - type: Resource    resource:      name: cpu      target:        type: Utilization        averageUtilization: 70`## üõ°Ô∏è Security Best Practices### Secret Management`bash# Use secret management systems# AWS Secrets Manageraws secretsmanager get-secret-value --secret-id hyperliquid-keys# HashiCorp Vaultvault kv get -field=private_key secret/hyperliquid# Kubernetes secretskubectl create secret generic hyperliquid-secrets \  --from-literal=private-key=your_private_key`### Network Security`bash# Run with non-root userUSER 1001EXPOSE 3000# Use TLS for productionSSL_CERT_PATH=/certs/server.crtSSL_KEY_PATH=/certs/server.key# Firewall rules (iptables)iptables -A INPUT -p tcp --dport 3000 -s trusted_subnet -j ACCEPTiptables -A INPUT -p tcp --dport 3000 -j DROP`### Container Security`dockerfile# Use minimal base imageFROM node:18-alpine# Create non-root userRUN addgroup -g 1001 -S nodejsRUN adduser -S hyperliquid -u 1001# Set security headersENV NODE_OPTIONS="--max-old-space-size=1024"ENV NODE_ENV=productionUSER hyperliquid`## üöÄ Production Deployment Patterns### High Availability Setup`yaml# docker-compose.prod.ymlversion: '3.8'services:  nginx:    image: nginx:alpine    ports:      - "80:80"      - "443:443"    volumes:      - ./nginx.conf:/etc/nginx/nginx.conf      - ./certs:/etc/nginx/certs    depends_on:      - hl-eco-mcp  hl-eco-mcp:    image: khrafts/hl-eco-mcp:latest    deploy:      replicas: 3    environment:      - NODE_ENV=production      - LOG_LEVEL=info    secrets:      - hyperliquid_private_key    healthcheck:      test: ["CMD", "curl", "-f", "http://localhost:3000/tools/health_check"]      interval: 30s      timeout: 10s      retries: 3  redis:    image: redis:alpine    command: redis-server --appendonly yes    volumes:      - redis_data:/datasecrets:  hyperliquid_private_key:    external: truevolumes:  redis_data:`### Blue-Green Deployment`bash#!/bin/bash# deploy.sh - Zero-downtime deploymentNEW_VERSION=$1CURRENT=$(docker-compose ps -q hl-eco-mcp | head -1)# Start new versiondocker-compose -f docker-compose.blue.yml up -d# Health checkfor i in {1..30}; do  if curl -f http://localhost:3001/tools/health_check; then    echo "New version healthy"    break  fi  sleep 2done# Switch trafficnginx -s reload# Stop old versiondocker stop $CURRENT`## üõ†Ô∏è Troubleshooting Playbooks### Common Issues & Solutions#### HyperLiquid API Issues`bash# Symptom: HyperLiquid tools failing# Check adapter healthcurl http://localhost:3000/tools/hyperliquid_health_check# Enable mock mode for testingMOCK_EXTERNAL_APIS=true hl-eco-mcp# Check API credentialsecho $HYPERLIQUID_PRIVATE_KEY | head -c 10`#### Rate Limiting`bash# Symptom: "Rate limit exceeded" errors# Increase rate limitsexport API_RATE_LIMIT_REQUESTS_PER_MINUTE=300# Check current usagecurl http://localhost:3000/metrics | grep rate_limit# Enable request queuingexport ENABLE_REQUEST_QUEUING=true`#### WebSocket Disconnections`bash# Check WebSocket statuscurl http://localhost:3000/tools/hyperliquid_websocket_status# Manual reconnectioncurl -X POST http://localhost:3000/admin/websocket/reconnect# Adjust reconnection settingsexport WEBSOCKET_RECONNECT_DELAY_MS=5000`#### Memory Leaks`bash# Monitor memory usageps aux | grep hl-eco-mcp# Enable heap dumpsexport NODE_OPTIONS="--max-old-space-size=2048 --heapdump-on-out-of-memory"# Graceful restartkill -SIGUSR2 $PID  # Triggers graceful shutdown`### Emergency Procedures#### Service Recovery1. **Check health endpoints** - Determine scope of issue2. **Review recent logs** - Identify root cause3. **Enable mock mode** - Maintain availability during outages4. **Scale horizontally** - Add instances if load-related5. **Rollback if needed** - Use previous known-good version#### Incident Response1. **Acknowledge** - Update status page, notify stakeholders2. **Investigate** - Use monitoring dashboards and logs3. **Mitigate** - Apply immediate fixes or workarounds4. **Resolve** - Deploy permanent solution5. **Post-mortem** - Document lessons learned---**üìû Need Help?** Check our [troubleshooting guide](troubleshooting.md) or [open an issue](https://github.com/khrafts/hyper-mcp/issues) for support.
